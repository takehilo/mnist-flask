{"version":3,"sources":["webpack:///./src/js/index.js"],"names":["HandwrittenNumberRecognition","canvas","document","getElementById","resetButton","result","canvasRect","getBoundingClientRect","ctx","getContext","lineWidth","lineCap","strokeStyle","isDown","predictUrl","API_URL","addEventListener","onMouseDown","bind","onMouseMove","onMouseUp","reset","e","x","clientX","left","y","clientY","top","beginPath","pos","getPosition","moveTo","lineTo","stroke","postImage","clearRect","width","height","fillStyle","fillRect","makeImage","then","blob","post","attach","res","displayResult","text","copyCanvas","createElement","copyCtx","drawImage","Promise","resolve","toBlob","textContent","window","onload"],"mappings":"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","file":"js/main.js","sourcesContent":["import request from 'superagent';\n\nclass HandwrittenNumberRecognition {\n  constructor() {\n    this.canvas = document.getElementById('canvas-main');\n    this.resetButton = document.getElementById('btn-reset');\n    this.result = document.getElementById('result');\n\n    this.canvasRect = this.canvas.getBoundingClientRect();\n    this.ctx = this.canvas.getContext('2d');\n    this.ctx.lineWidth = 20;\n    this.ctx.lineCap = 'round';\n    this.ctx.strokeStyle = 'white';\n    this.isDown = false;\n\n    this.predictUrl = API_URL + '/predict';\n\n    this.canvas.addEventListener('mousedown', this.onMouseDown.bind(this));\n    this.canvas.addEventListener('mousemove', this.onMouseMove.bind(this));\n    this.canvas.addEventListener('mouseup', this.onMouseUp.bind(this));\n\n    this.resetButton.addEventListener('click', this.reset.bind(this));\n\n    this.reset();\n  }\n\n  getPosition(e) {\n    return {\n      x: e.clientX - this.canvasRect.left,\n      y: e.clientY - this.canvasRect.top\n    };\n  }\n\n  onMouseDown(e) {\n    this.isDown = true;\n    this.ctx.beginPath();\n    let pos = this.getPosition(e);\n    this.ctx.moveTo(pos.x, pos.y);\n  }\n\n  onMouseMove(e) {\n    if (!this.isDown) {\n      return;\n    }\n    const pos = this.getPosition(e);\n    this.ctx.lineTo(pos.x, pos.y);\n    this.ctx.stroke();\n  }\n\n  onMouseUp() {\n    if (!this.isDown) {\n      return;\n    }\n    this.isDown = false;\n    this.postImage();\n  }\n\n  reset() {\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.ctx.fillStyle = 'black';\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n  }\n\n  postImage() {\n    this.makeImage()\n      .then((blob) => {\n        return request.post(this.predictUrl)\n          .attach('file', blob);\n      })\n      .then((res) => {\n        this.displayResult(res.text);\n      });\n  }\n\n  makeImage() {\n    const copyCanvas = document.createElement('canvas');\n    copyCanvas.width = 28;\n    copyCanvas.height = 28;\n    const copyCtx = copyCanvas.getContext('2d');\n    copyCtx.fillStyle = 'black';\n    copyCtx.fillRect(0, 0, copyCanvas.width, copyCanvas.height);\n    copyCtx.drawImage(this.canvas,\n      0, 0, this.canvas.width, this.canvas.height,\n      0, 0, copyCanvas.width, copyCanvas.height);\n\n    return new Promise((resolve) => {\n      copyCanvas.toBlob((blob) => {\n        resolve(blob);\n      });\n    });\n  }\n\n  displayResult(text) {\n    this.result.textContent = text;\n  }\n}\n\nwindow.onload = () => new HandwrittenNumberRecognition();\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/index.js"],"sourceRoot":""}